--/ bitop.lua by H3x0R
local a,b,c,d,e=math.fmod,math.max,math.floor,table.insert,table.concat;local f=function(...)local g={...}local h;local i;for j,k in ipairs(g)do if j==1 then h=k elseif j%2~=0 then assert(type(k)==i,"bad argument #"..j/2-0.5 .." to '"..h.."' ("..i.." expected, got "..type(k)..")")else i=k end end end;local l={}local m=0xFFFFFFFF;local n=0xFFFFFFFF+1;local o={}local p={}local function q(r,s)f("CreateBitTable","number",r)if not r then return end;if not s then o={}p={}end;if(r or 0)==0 then for j,k in pairs(o)do p[#o-j+1]=k end;return p end;d(o,a(r,2))return q(c(r/2),true)end;local function t(u)f("CreateBitOperation","table",u)local function v(w,x)w=w or 0;x=x or 0;for y,z in pairs(u)do if w==z[1]and x==z[2]then return z[3]end end end;local function A(w,x)if not x then return w end;w=q(w)x=q(x)local B={}local C,D=#w,#x;local E=b(C,D)for j=0,E-1 do local F,G=w[C-j],x[D-j]if not(F or G)then break end;B[E-j]=v(F,G)end;return A(tonumber(e(B),2))end;return A end;local function H(I)f("tobit","number",I)I=a(I,n)if I>=0x80000000 then I=I-n;return I end;return I end;local function J(I,K)f("tohex","number",I,"number",K)K=K or 8;return string.format("%0"..tostring(K).."x",I)end;local L=t({{0,0,0},{0,1,0},{1,0,0},{1,1,1}})local M=t({{0,0,0},{0,1,1},{1,0,1},{1,1,1}})local N=t({{0,0,0},{0,1,1},{1,0,1},{1,1,0}})local function O(w)f("bnot","number",w)return H(m-w)end;local P,Q;P=function(w,R)f("lshift","number",w,"number",R)if R<0 then return Q(w,-R)end;return a(w*2^R,m)end;Q=function(w,R)f("rshift","number",w,"number",R)R=R or 1;if R<0 then return P(w,-R)end;return c(a(w,m)/2^R)end;local function S(w,R)f("arshift","number",w,"number",R)w=a(w,m)if R>=0 then if R>31 then return R>=0x80000000 and n or 0 else local T=Q(w,R)if w>=0x80000000 then T=T+P(2^R-1,32-R)end;return T end else return P(w,-R)end end;local function U(w)f("bswap","number",w)local V=L(w,0xFF)w=Q(w,8)local W=L(w,0xFF)w=Q(w,8)local X=L(w,0xFF)w=Q(w,8)local Y=L(w,0xFF)return P(P(P(V,8)+W,8)+X,8)+Y end;local function Z(w,R)R=R%32;return Q(w,R)+P(L(2^R-1),32-R)end;local function _(w,R)return Z(w,-R)end;l.tobit=H;l.tohex=J;l.band=function(w,x,a0,...)f("band","number",w)if a0 then return l.band(l.band(w,x),a0,...)elseif x then return H(L(w%m,x%m))else return H(w)end end;l.bor=function(w,x,a0,...)f("bor","number",w)if a0 then return l.bor(l.bor(w,x),a0,...)elseif x then return H(M(w%m,x%m))else return H(w)end end;l.bxor=function(w,x,a0,...)f("bxor","number",w)if a0 then return l.bxor(l.bxor(w,x),a0,...)elseif x then return H(N(w%m,x%m))else return H(w)end end;l.bnot=function(w)return H(O(w))end;l.lshift=function(w,R)return H(P(w,R))end;l.rshift=function(w,R)return H(Q(w,R))end;l.arshift=function(w,R)return H(S(w,R))end;l.bswap=function(w)return H(U(w))end;l.ror=function(w,R)f("ror","number",w,"number",R)return Z(w,R)end;l.rol=function(w,R)f("rol","number",w,"number",R)return _(w,R)end;l.rrotate=function(w,R)f("rrotate","number",w,"number",R)return Z(w,R)end;l.lrotate=function(w,R)f("lrotate","number",w,"number",R)return _(w,R)end;return l